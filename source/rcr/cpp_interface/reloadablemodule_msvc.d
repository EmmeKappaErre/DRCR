module rcr.cpp_interface.reloadablemodule_msvc;

import std.conv;
import rcr.reloadablemodule_msvc;

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
extern(C++) class ReloadableModule_MSVC
{
public:
    alias ReloadFlag = rcr.reloadablemodule.ReloadFlag;

	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	this(const char* vcvarsallPath,
		 const char* solutionFullPath,
		 const char* dllSourceDirectory,
		 const char* dllName,
		 const char* projectName,
         const char* configuration)
	{
        m_dModule = new rcr.reloadablemodule_msvc.ReloadableModule_MSVC(to!string(vcvarsallPath),
                                                                        to!string(solutionFullPath),
                                                                        to!string(dllSourceDirectory),
                                                                        to!string(dllName),
                                                                        to!string(projectName),
                                                                        to!string(configuration));
	}

    bool requestReload(ReloadFlag flag = ReloadFlag.eCompileAndReload)
	{
        return m_dModule.requestReload(flag);
    }

    void processReload()
	{
        m_dModule.processReload();
    }

private:
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
    rcr.reloadablemodule_msvc.ReloadableModule_MSVC m_dModule;
}